const $state=new Proxy({},{set:function(e,n,t){return onStateChange(n,t),e[n]=t,!0}}),setState=e=>Object.keys(e).forEach(n=>$state[n]=e[n]),getState=()=>$state,$conditionalStyles=[];function onStateChange(e,n){$conditionalStyles.forEach(t=>{`$${t.key}`===e&&!0===n&&applyStyleGroupInElement(t.ref,t.styleGroup)})}class Observable{constructor(){let e=[];this.subscribe=function(n){e.push(n)},this.unsubscribe=function(n){e=e.filter(e=>e!==n)},this.notify=function(n){e.forEach(e=>e(n))},this.clear=function(){e=[]}}}const createElement=(e,n,t=1)=>{let r=[];if(n.forEach)return n.forEach(n=>{for(let i=0;i<t;i++){const t=document.createElement(e);n.appendChild(t),r.push(t)}}),r;for(let i=0;i<t;i++){const t=document.createElement(e);n.appendChild(t),r.push(t)}return 1===r.length&&(r=r[0]),r},insertTextInElement=(e,n)=>{if(!e)throw new Error("Element required");if(!n)throw new Error("Element required");if("object"!=typeof e)throw new Error("Element must be a object");if(!e.nodeName)throw new Error("Element must be a html element");if("string"!=typeof n)throw new Error("Text must be a string");e.children?e.appendChild(document.createTextNode(n)):e.innerText=n},dictionaryCSSProperties={alignment:cssAlignment,width:cssWidth,height:cssHeight,bg:cssBg,background:cssBg,shape:cssShape},createStyleGroup=(e,n)=>{let t={};const r=document.createElement("div");return e.split(";").forEach(e=>{const i=e.split(":");if(2==i.length)if(dictionaryCSSProperties[i[0]])t={...t,...dictionaryCSSProperties[i[0]](i,n)};else if(i[1].split(" ").length<2){if(!Object.keys(r.style).includes(i[0]))throw new Error(`Invalid css propertie "${i[0]}"`);t[i[0]]=i[1]}}),t},applyStyleGroupInElement=(e,n)=>{e.length>0?e.forEach(e=>{Object.entries(n).forEach(n=>e.style[n[0]]=n[1])}):Object.entries(n).forEach(n=>e.style[n[0]]=n[1])},compareStates=(e,n)=>Object.keys(e).reduce((t,r)=>!!t&&e[r]===n[r],!0),setPlatformRules=e=>{const n={};let t=$state;e.forEach(e=>{n[`$${e.identifier}`]=e.expression(window.innerWidth)}),setState(n),window.addEventListener("resize",()=>{const n={};e.forEach(e=>{n[`$${e.identifier}`]=e.expression(window.innerWidth)}),compareStates(n,t)||(t=n,setState(n))})},setConditionalStyle=(e,n,t)=>($conditionalStyles.push({key:e,ref:n,styleGroup:t}),()=>applyStyleGroupInElement(n,t));export default{createElement:createElement,applyStyleGroupInElement:applyStyleGroupInElement,insertTextInElement:insertTextInElement,createStyleGroup:createStyleGroup,setPlatformRules:setPlatformRules,onStateChange:onStateChange,setConditionalStyle:setConditionalStyle,getState:getState};const isTypeOfNumberWithUnit=e=>!!e.match(/(0|\d+(px|%|vw|vh|rem|em))/g)[0]&&e===e.match(/(0|\d+(px|%|vw|vh|rem|em))/g)[0];function cssAlignment(e){const n={display:"flex",justifyContent:"center",alignItems:"center"},t={start:"flex-start",center:"center",end:"flex-end"},r={start:"flex-start",center:"center",end:"flex-end",evenly:"space-evenly",around:"space-around",between:"space-between"},i=e[1].split(" "),o=["column","row"];return i.includes("col")&&(i[i.indexOf("col")]="column"),i.forEach((i,s,c)=>{if(0==s){if(!o.includes(i))throw new Error(`The style expression "${e.join(": ")}" contains an error\nUnexpected -> "${i}"`);n.flexDirection=i}if(1==s&&"wrap"!==i)if("row"==c[s-1]){if(!Object.keys(r).includes(i))throw new Error(`The style expression "${e.join(": ")}" contains an error\nUnexpected -> "${i}"`);n.justifyContent=r[i]}else{if(!Object.keys(t).includes(i))throw new Error(`The style expression "${e.join(": ")}" contains an error\nUnexpected -> "${i}"`);n.alignItems=t[i]}if(2==s){if("wrap"==i)throw new Error(`The style expression "${e.join(": ")}" contains an error\nUnexpected -> "${i}"`);if("row"==c[s-2]){if(!Object.keys(t).includes(i))throw new Error(`The style expression "${e.join(": ")}" contains an error\nUnexpected -> "${i}"`);n.alignItems=t[i]}else{if(!Object.keys(r).includes(i))throw new Error(`The style expression "${e.join(": ")}" contains an error\nUnexpected -> "${i}"`);n.justifyContent=r[i]}}if((1==s||3==s)&&"wrap"===i)if(c[s+1]){if("normal"!=c[s+1]&&"reverse"!=c[s+1])throw new Error(`The style expression "${e.join(": ")}" contains an error\nUnexpected -> "${c[s+1]}"`);"normal"==c[s+1]&&(n.flexWrap="wrap"),"reverse"==c[s+1]&&(n.flexWrap="wrap-reverse")}else n.flexWrap="wrap"}),n}function cssWidth(e,n){const t={},r=e[1].split(" ");if(r.forEach((r,i,o)=>{if(!isTypeOfNumberWithUnit(o[0]))throw new Error(`The style expression "${e.join(": ")}" contains an error\nUnexpected -> "${o[0]}"\nExpecting 0 | <number> + (px | % | vw | vh | rem | em)`);if(0==i&&(t.width=r),1==i&&"of"===r){if(isTypeOfNumberWithUnit(o[0].replace("%","")))throw new Error(`The style expression "${e.join(": ")}" contains an error\nUnexpected -> "${o[0]}"\nExpecting some percentual value`);if(!o[2])throw new Error(`The style expression "${e.join(": ")}"\nExpecting a reference to compair"`);let r=0!=+o[0].replace("%","")?+o[0].replace("%","")/100:0;if("window"===o[2])return t.width=Math.floor(window.innerWidth*r)+"px",t;const i=n.filter(e=>e.name===o[2]);if(!i.length)throw new Error(`The style expression "${e.join(": ")}" contains an error\nUnexpected -> "${o[2]}" - the variable reference does not exist`);t.width=Math.floor(i[0].ref.offsetWidth*r)+"px"}}),r.includes("max")||r.includes("min")){(r.includes("of")?r.slice(3,r.length):r.slice(1,r.length)).forEach((n,r,i)=>{if(r%2==0&&1!=r){if(!["max","min"].includes(n))throw new Error(`The style expression "${e.join(": ")}" contains an erro\nUnexpected -> "${n}"\nExpecting (min | max) as flag key`);if(!i[r+1])throw new Error(`The style expression "${e.join(": ")}" contains an erro\nExpecting a value assignment for ${n} flag`);if(!isTypeOfNumberWithUnit(i[r+1]))throw new Error(`The style expression "${e.join(": ")}" contains an erro\nUnexpected -> "${i[r+1]}"\nExpecting 0 | <number> + (px | % | vw | vh | rem | em)`);"max"===n?t.maxWidth=i[r+1]:t.minWidth=i[r+1]}})}return t}function cssHeight(e){const n={},t=e[1].split(" ");if(t.forEach((t,r,i)=>{if(!isTypeOfNumberWithUnit(i[0]))throw new Error(`The style expression "${e.join(": ")}" contains an error\nUnexpected -> "${i[0]}"\nExpecting 0 | <number> + (px | % | vw | vh | rem | em)`);if(0==r&&(n.height=t),1==r&&"of"===t){if(isTypeOfNumberWithUnit(i[0].replace("%","")))throw new Error(`The style expression "${e.join(": ")}" contains an error\nUnexpected -> "${i[0]}"\nExpecting some percentual value`);if(!i[2])throw new Error(`The style expression "${e.join(": ")}"\nExpecting a reference to compair"`);let t=0!=+i[0].replace("%","")?+i[0].replace("%","")/100:0;if("window"===i[2])return n.height=Math.floor(window.innerHeight*t)+"px",n;const r=references.filter(e=>e.name===i[2]);if(!r.length)throw new Error(`The style expression "${e.join(": ")}" contains an error\nUnexpected -> "${i[2]}" - the variable reference does not exist`);n.height=Math.floor(r[0].ref.offsetHeight*t)+"px"}}),t.includes("max")||t.includes("min")){(t.includes("of")?t.slice(3,t.length):t.slice(1,t.length)).forEach((t,r,i)=>{if(r%2==0&&1!=r){if(!["max","min"].includes(t))throw new Error(`The style expression "${e.join(": ")}" contains an erro\nUnexpected -> "${t}"\nExpecting (min | max) as flag key`);if(!i[r+1])throw new Error(`The style expression "${e.join(": ")}" contains an erro\nExpecting a value assignment for ${t} flag`);if(!isTypeOfNumberWithUnit(i[r+1]))throw new Error(`The style expression "${e.join(": ")}" contains an erro\nUnexpected -> "${i[r+1]}"\nExpecting 0 | <number> + (px | % | vw | vh | rem | em)`);"max"===t?n.maxHeight=i[r+1]:n.minHeight=i[r+1]}})}return n}function cssShape(e){const n={},t=e[1].split(" ");if(t.length>2)throw new Error(`The style expression "${e.join(": ")}" contains an erro\nExpects (circle | square) && <number> + (px | vw | vh | rem | em)`);if(1==t.length)throw new Error(`The style expression "${e.join(": ")}" contains an erro\nOne argument is missing`);if(!["circle","square"].includes(t[0]))throw new Error(`The style expression "${e.join(": ")}" contains an erro\nUnexpected -> "${t[0]}"\nExpecting (circle | square)`);if(!isTypeOfNumberWithUnit(t[1]))throw new Error(`The style expression "${e.join(": ")}" contains an erro\nUnexpected -> "${t[1]}"\nExpecting <number> + (px | vw | vh | rem | em)`);if("0"==t[1])throw new Error(`The style expression "${e.join(": ")}" contains an erro\nUnexpected -> "${t[1]}"\nExpecting a value greater then 0`);if(!isTypeOfNumberWithUnit(t[1].replace("%","")))throw new Error(`The style expression "${e.join(": ")}" contains an erro\nUnexpected -> "${t[1]}"\nPercentage values are not allowed`);return n.width=t[1],n.height=t[1],"circle"==t[0]&&(n.borderRadius="50%"),n}function cssBg(e){const n={};return n.background=e[1],n}